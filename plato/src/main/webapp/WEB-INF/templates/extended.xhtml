<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:x="http://java.sun.com/jsf/composite/htmlx"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://java.sun.com/jsf/composite/plato"
	template="/WEB-INF/templates/default.xhtml"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

	<ui:define name="scripts">
		<script type="text/javascript">
	  function getChangedflagInputs() {
	      var changedflags = new Array();
	      var forms = document.getElementsByTagName("form");
	      for (var i=0; i &lt; forms.length; i++) {
		      var changedflag = document.getElementById(forms[i].id + ':changedflag');
		      if (changedflag != null) { changedflags.push(changedflag); }
		  }
	      return changedflags;
	  }
	  function mayExit_noClick() {
	      var changedflags = getChangedflagInputs();
	      for (var i=0; i &lt; changedflags.length; i++) {
	    	  var changedflag = changedflags[i];
		      if ((changedflag.value != null) &amp;&amp; (changedflag.value != '')) { 
	             // there are some changes, stay
	             alert('There are unsaved changes, please save or discard the changes first.');
	             return false
	          }
	      }
	      return true
	  }
	  function mayExit(target) {
		  if (mayExit_noClick()) {
	          var button = document.getElementById('menuform:' + target + 'Button');
	          button.click();
	          return true
		  } else {
			  return false
		  }

	  }
	  function changed() {
          var changedflags = getChangedflagInputs();
          for (var i=0; i &lt; changedflags.length; i++) {
              changedflags[i].value="T";
          }
	      // in some places changed() is called before other funtions, make sure they are called too
	      return true;
	  }
	</script>
	</ui:define>


	<ui:define name="menu">
		<div id="feedback">
			<h:link value="feedback" outcome="/feedback.jsf" />
		</div>
		<script type="text/javascript">
		$(document).ready(
			function() {
				//add feedback animation 
            	$('#feedback').hover(
                	function() {
                		$(this).animate({right: '+=10'}, 200, function() {});
                	}, 
                	function() {
                    	$(this).animate({right: '-=10'}, 200, function() {});
            		}
             	);

				//reset position on click 
    	        $('#feedback').click(
    	    		function() {
						$(this).css('right', '-70px');
            		}
                );
			}
		);
	</script>

		<ui:fragment rendered="#{viewWorkflowManager.active}">
			<ui:include src="/plato/shared/menu.xhtml">
				<ui:param name="viewWorkflow" value="#{viewWorkflow}" />
			</ui:include>
		</ui:fragment>
		<ui:fragment rendered="#{!viewWorkflowManager.active}">
			<ui:include src="/plato/shared/menu.xhtml">
				<ui:param name="viewWorkflow" value="null" />
			</ui:include>
		</ui:fragment>
	</ui:define>

</ui:composition>