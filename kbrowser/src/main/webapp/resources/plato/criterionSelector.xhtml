<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">

<cc:interface>
	<cc:attribute name="id" required="false" />
	<cc:attribute name="criterionSelector" />
	<cc:attribute name="renderOnCategoryChanged" required="false" />
	<cc:attribute name="renderOnAttributeChanged" required="false" />
	<cc:attribute name="renderOnMeasureChanged" required="false" />
</cc:interface>

<cc:implementation>

	<h:outputStylesheet library="css" name="criterionselector.css"
		target="head" />

	<div class="component">

		<table class="criterionselector-table">
			<tr>
				<th></th>
				<th>Measure selection</th>
				<th></th>
			</tr>
			<tr>
				<th style="width: 30%;"><i>Category</i></th>
				<th style="width: 30%;"><i>Attribute</i></th>
				<th style="width: 30%;"><i>Measure</i></th>
			</tr>
			<tr>
				<td><h:selectOneListbox size="7"
						id="#{cc.attrs.id}_categories_select"
						value="#{cc.attrs.criterionSelector.selectedCategoryName}"
						required="false" styleClass="criterionselector-select">
						<f:selectItems value="#{cc.attrs.criterionSelector.categories}"
							var="cat" noSelectionValue="(all)" itemLabel="#{cat.name}"
							itemValue="#{cat.name}" />
						<a4j:ajax event="change"
							render="#{cc.attrs.id}_attributes_select #{cc.attrs.id}_measures_select #{cc.attrs.id}_measure_description #{cc.attrs.id}_children #{cc.attrs.renderOnCategoryChanged} #{cc.attrs.renderOnAttributeChanged} #{cc.attrs.renderOnMeasureChanged}"
							listener="#{cc.attrs.criterionSelector.categorySelected}" />
					</h:selectOneListbox></td>
				<td><h:selectOneListbox size="7"
						id="#{cc.attrs.id}_attributes_select"
						value="#{cc.attrs.criterionSelector.selectedAttributeName}"
						required="false" styleClass="criterionselector-select">
						<f:selectItems
							value="#{cc.attrs.criterionSelector.filteredAttributes}"
							var="attr" itemLabel="#{attr.name}" itemValue="#{attr.name}"
							noSelectionValue="(all)" />
						<a4j:ajax event="change"
							render="#{cc.attrs.id}_measures_select #{cc.attrs.id}_measure_description #{cc.attrs.id}_children #{cc.attrs.renderOnAttributeChanged} #{cc.attrs.renderOnMeasureChanged}"
							listener="#{cc.attrs.criterionSelector.attributeSelected}" />
					</h:selectOneListbox></td>
				<td><h:selectOneListbox size="7"
						id="#{cc.attrs.id}_measures_select"
						value="#{cc.attrs.criterionSelector.selectedMeasureName}"
						required="false" styleClass="criterionselector-select">
						<f:selectItems
							value="#{cc.attrs.criterionSelector.filteredMeasures}"
							var="measure" itemLabel="#{measure.name}"
							itemValue="#{measure.name}" noSelectionLabel="(none)" />
						<a4j:ajax event="change"
							render="#{cc.attrs.id}_measure_description #{cc.attrs.id}_children #{cc.attrs.renderOnMeasureChanged}"
							listener="#{cc.attrs.criterionSelector.measureSelected}" />
					</h:selectOneListbox></td>
			</tr>
		</table>
		<h:panelGroup id="#{cc.attrs.id}_measure_description">
			<table class="criterionselector-desc-tab border">
				<tr>
					<th class="align-left" style="width: 20em;">Measure
						characteristic</th>
					<th class="align-left" style="width: 40em;">Value</th>
				</tr>
				<tr>
					<td>Category</td>
					<td><h:outputText
							value="#{cc.attrs.criterionSelector.selectedCategory.name}"
							rendered="#{cc.attrs.criterionSelector.selectedCategory != null}" /></td>
				</tr>
				<tr>
					<td>Attribute description</td>
					<td><h:outputText
							value="#{cc.attrs.criterionSelector.selectedAttribute.description}"
							rendered="#{cc.attrs.criterionSelector.selectedAttribute != null}" /></td>
				</tr>
				<tr>
					<td>Measure</td>
					<td><h:outputText
							value="#{cc.attrs.criterionSelector.selectedMeasure.description}"
							rendered="#{cc.attrs.criterionSelector.selectedMeasure != null}" /></td>
				</tr>
			</table>
		</h:panelGroup>

		<a4j:outputPanel id="#{cc.attrs.id}_children">
			<cc:insertChildren />
		</a4j:outputPanel>

	</div>
</cc:implementation>
</html>